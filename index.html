<!DOCTYPE html>
<html>
<head>
	<meta charset='utf-8'/>
	<title>Boot to JS</title>
	<script>
		const post = x => fetch('/', { method: 'POST', body: x })
		const fetch_text = x => x.text()
		const remote = (f, then=fetch_text) => (...xs) => post(`(${f.toString()})(${xs.map(JSON.stringify).join(',')})`).then(then)
		const app_dir = remote(() => __dirname)

		function main() {
			app_dir().then(console.log)
		}

		window.onload = main
	</script>
</head>
<body>
	<h1>Hello, world!</h1>
</body>
</html>
